#pragma ident "$Id: loadf.c,v 1.2 2015/10/30 22:28:08 dechavez Exp $"
/*======================================================================
 *
 * Load the filters
 *
 *====================================================================*/
#include "vhfilt.h"

#define PASS0_FILTER {                                                                                             \
    99, 0.0,                                                                                                               \
    {                                                                                                                      \
        -3.37741172235555e-07, -8.62909469475743e-07, -1.54941637051279e-06, -2.04037321988896e-06, -1.60360817158757e-06, \
         8.76700880170391e-07,  6.73038531575341e-06,  1.70899755724285e-05,  3.22291754544460e-05,  5.07341123270600e-05, \
         6.87045863189250e-05,  7.92878477559661e-05,  7.29083155735815e-05,  3.85255943515061e-05, -3.38990117967917e-05, \
        -1.49823778528152e-04, -3.05914893943259e-04, -4.86084065632507e-04, -6.58987900726472e-04, -7.78326907813420e-04, \
        -7.87101831381127e-04, -6.26427167073746e-04, -2.48596805885912e-04,  3.67087727133989e-04,  1.19835634978318e-03, \
         2.16751275768587e-03,  3.13647335496660e-03,  3.91288808241676e-03,  4.26971324330446e-03,  3.97828836449010e-03, \
         2.85238869692266e-03,  7.97673218452270e-04, -2.14136330850277e-03, -5.74628878003951e-03, -9.61061070593462e-03, \
        -1.31538246322395e-02, -1.56670327775064e-02, -1.63886980634320e-02, -1.46032479179499e-02, -9.75057269261745e-03, \
        -1.53045943011789e-03,  1.00149445062870e-02,  2.44562167601639e-02,  4.09803943535677e-02,  5.84476704081578e-02, \
         7.54974158180997e-02,  9.06920444106684e-02,  1.02680217956437e-01,  1.10357260936311e-01,  1.13000042162254e-01, \
         1.10357260936311e-01,  1.02680217956437e-01,  9.06920444106684e-02,  7.54974158180997e-02,  5.84476704081578e-02, \
         4.09803943535677e-02,  2.44562167601639e-02,  1.00149445062870e-02, -1.53045943011789e-03, -9.75057269261745e-03, \
        -1.46032479179499e-02, -1.63886980634320e-02, -1.56670327775064e-02, -1.31538246322395e-02, -9.61061070593462e-03, \
        -5.74628878003951e-03, -2.14136330850277e-03,  7.97673218452270e-04,  2.85238869692266e-03,  3.97828836449010e-03, \
         4.26971324330446e-03,  3.91288808241676e-03,  3.13647335496660e-03,  2.16751275768587e-03,  1.19835634978318e-03, \
         3.67087727133989e-04, -2.48596805885912e-04, -6.26427167073746e-04, -7.87101831381127e-04, -7.78326907813420e-04, \
        -6.58987900726472e-04, -4.86084065632507e-04, -3.05914893943259e-04, -1.49823778528152e-04, -3.38990117967917e-05, \
         3.85255943515061e-05,  7.29083155735815e-05,  7.92878477559661e-05,  6.87045863189250e-05,  5.07341123270600e-05, \
         3.22291754544460e-05,  1.70899755724285e-05,  6.73038531575341e-06,  8.76700880170391e-07, -1.60360817158757e-06, \
        -2.04037321988896e-06, -1.54941637051279e-06, -8.62909469475743e-07, -3.37741172235555e-07,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00                                                                                              \
    }                                                                                                                      \
}
#define PASS0_DECIMATION 5

#define PASS1_FILTER {                                                                                             \
    41, 0.0,                                                                                                               \
    {                                                                                                                      \
        -4.37277543655446e-07, -4.82801027074436e-06, -2.65789291225044e-05, -9.47667419127147e-05, -2.36451055257277e-04, \
        -4.05383349303201e-04, -3.72431439911244e-04,  2.93047105382995e-04,  1.93678294145069e-03,  4.16007818890067e-03, \
         5.19007065175525e-03,  2.17544214795206e-03, -6.85295453791835e-03, -1.98534426519137e-02, -2.86946125362195e-02, \
        -2.09204607745684e-02,  1.37748558164710e-02,  7.53028085080624e-02,  1.48903546801816e-01,  2.09347513604984e-01, \
         2.32756403074331e-01,  2.09347513604984e-01,  1.48903546801816e-01,  7.53028085080624e-02,  1.37748558164710e-02, \
        -2.09204607745684e-02, -2.86946125362195e-02, -1.98534426519137e-02, -6.85295453791835e-03,  2.17544214795206e-03, \
         5.19007065175525e-03,  4.16007818890067e-03,  1.93678294145069e-03,  2.93047105382995e-04, -3.72431439911244e-04, \
        -4.05383349303201e-04, -2.36451055257277e-04, -9.47667419127147e-05, -2.65789291225044e-05, -4.82801027074436e-06, \
        -4.37277543655446e-07,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00,  0.00000000000000e-00, \
         0.00000000000000e-00                                                                                              \
    }                                                                                                                      \
}
#define PASS1_DECIMATION 2

void LoadFilters(VHFILT *vhfilt)
{
int i;
int sint = 1; /* We KNOW this because we reject non-1Hz data in ReadInput() */
static int decimation[2] = { PASS0_DECIMATION, PASS1_DECIMATION };
static FILTER_COEFF coeff[2] = { PASS0_FILTER, PASS1_FILTER };
static char *fid = "LoadFilter";

    vhfilt->delay = 0;

    for (i = 0; i < VHFILT_NPASS; i++) {
        vhfilt->pass[i].filter.type = FILTER_TYPE_FIR_SYM;
        vhfilt->pass[i].filter.data.cf = coeff[i];
        vhfilt->pass[i].decimation = decimation[i];
        vhfilt->delay += ((coeff[i].ncoef - 1) / 2) * sint;
        sint *= decimation[i];
    }
    vhfilt->minsamp = ((vhfilt->delay+1) * 2) + (((vhfilt->delay+1) * 2) / 10);
    vhfilt->delay *= NANOSEC_PER_SEC;
}

/*-----------------------------------------------------------------------+
 |                                                                       |
 | Copyright (C) 2015 Regents of the University of California            |
 |                                                                       |
 | This software is provided 'as-is', without any express or implied     |
 | warranty.  In no event will the authors be held liable for any        |
 | damages arising from the use of this software.                        |
 |                                                                       |
 | Permission is granted to anyone to use this software for any purpose, |
 | including commercial applications, and to alter it and redistribute   |
 | it freely, subject to the following restrictions:                     |
 |                                                                       |
 | 1. The origin of this software must not be misrepresented; you must   |
 |    not claim that you wrote the original software. If you use this    |
 |    software in a product, an acknowledgment in the product            |
 |    documentation of the contribution by Project IDA, UCSD would be    |
 |    appreciated but is not required.                                   |
 | 2. Altered source versions must be plainly marked as such, and must   |
 |    not be misrepresented as being the original software.              |
 | 3. This notice may not be removed or altered from any source          |
 |    distribution.                                                      |
 |                                                                       |
 +-----------------------------------------------------------------------*/

/* Revision History
 *
 * $Log: loadf.c,v $
 * Revision 1.2  2015/10/30 22:28:08  dechavez
 * initial production release
 *
 */
